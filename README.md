# MALDI-PeakHunter
MALDI PeakHunter is a Python-based desktop application designed for mass spectrometry researchers. It provides a lightweight, interactive interface for visualizing mass spectra, performing peak picking, and identifying compounds via the PubChem API or a local library.It is specifically tuned for MALDI (Matrix-Assisted Laser Desorption/Ionization) data analysis, supporting various instrument resolutions and common adduct calculations.

üåü Key FeaturesInteractive Visualization:
Zoomable, clickable stem plots generated via Matplotlib embedded in Tkinter.
Real-time Database Search:PubChem Integration: Automatically searches the NCBI PubChem database based on precursor mass.Local Library: SQLite-based local storage for custom compound libraries.
Smart Filtering:Adduct Handling: Automatic calculation of neutral mass based on selected adducts (e.g., [M+H]+, [M+Na]+).
Class Filtering: Filter results by chemical category (Lipids, Peptides, Metabolites, etc.).
PPM Error Limits: Set strict mass accuracy thresholds.Structure Preview: Fetches and displays 2D chemical structures (PNG) directly from PubChem upon selecting a result.
Data Export: Export identification results to .csv for further analysis.
Non-Blocking UI: Uses threading for network requests to keep the GUI responsive during heavy data fetching.

üõ† InstallationPrerequisites
Python 3.8+Internet connection (for PubChem API)DependenciesInstall the required Python packages using pip:Bashpip install numpy matplotlib requests pillow
Note: tkinter and sqlite3 are included in standard Python distributions. If you are on Linux, you may need to install python3-tk separately.Running the ApplicationBashpython main.py
(Replace main.py with the actual name of your script file)üìñ User Guide1. ConfigurationOn the left panel, configure your search parameters:Instrument: Select a preset (e.g., "MALDI MRT", "Synapt G2") to auto-set mass tolerance, or enter a custom tolerance.Adduct: Choose the ionization adduct (e.g., [M+H]+). This adjusts the search mass to find the neutral compound.Filters: Check boxes to prioritize specific chemical classes (e.g., "Lipids", "Drugs") or enforce a specific PPM error limit.2. Input DataPaste your peak list into the Input Spectrum text box.Format: m/z, intensity (one peak per line).Example:Plaintext411.22046, 10000
611.09, 50000
3. AnalysisClick Generate Plot to visualize the spectrum.Click on any peak stem in the plot to instantly trigger a PubChem search for that specific m/z.Alternatively, click Search Local DB to query your offline library.4. ResultsMatches appear in the table at the bottom.Click a row to view the chemical Structure on the bottom right.Click Export Results to save the table as a CSV file.üíª Code Documentation & ArchitectureThis section is for developers contributing to the project or modifying the source code.1. Global ConfigurationsThe script uses dictionaries at the top level to manage domain knowledge easily:ADDUCTS: Stores mass shifts for different ionization states.INSTRUMENTS: Maps instrument names to default mass tolerances (Da).CLASS_KEYWORDS: A keyword mapping used to tag results (e.g., detecting "cholest" string implies "Sterols").2. Class: MassSpecAppThe main controller class that inherits from the Tkinter root.A. GUI LayoutThe interface is divided into two main ttk.Frame panels:pan_left: Controls, Settings, and Text Input.pan_right: Matplotlib Canvas (Top) and Results/Image Viewer (Bottom).B. Threading & Network LogicTo prevent the GUI from freezing during API calls, the app uses the threading module.start_search_thread: Initiates a background thread. It generates a unique search_id (timestamp) to ensure that if the user clicks multiple peaks quickly, old search results don't overwrite newer ones (Race condition handling).safe_gui_call: A helper method using root.after(0, callback). This is crucial because Tkinter is not thread-safe; UI updates must happen on the main thread.C. Plotting EngineUses matplotlib.backends.backend_tkagg to embed plots.plot_spectrum: Parses text input and generates a Stem Plot.update_visible_labels: dynamic label generation. It listens to the plot's zoom event (xlim_changed) and only labels the "Top N" peaks currently visible in the view, preventing text clutter.D. API Interaction (requests)setup_network_session: Configures a requests.Session with urllib3 retry logic (backoff factor) to handle intermittent network failures gracefully.search_pubchem:Calculates Neutral Mass: $Mass_{neutral} = Mass_{observed} - Mass_{adduct}$.Fetches CIDs (Compound IDs) from PubChem within the defined tolerance range.Calls fetch_filter_rank to get details (Formula, Name) for the top 40 CIDs.fetch_structure_image: Downloads the 2D PNG representation of a molecule asynchronously.E. Data Processingparse_input_spectrum: robustly handles CSV-like text input, stripping whitespace and handling tabs/commas.fetch_filter_rank:Downloads compound metadata.Calculates PPM Error: $\frac{|Mass_{db} - Mass_{theoretical}|}{Mass_{db}} \times 10^6$.Performs string matching against CLASS_KEYWORDS to populate the "ClassMatch" column.üîÆ Future Roadmap[ ] Implementation of MS/MS fragment matching.[ ] Batch processing mode (multiple files).[ ] Integration with LipidMaps API for specialized lipidomics.[ ] Dark Mode UI support.üìÑ LicenseThis project is open-source. Please refer to the LICENSE file for details.ü§ù ContactMaintainer: [Your Name/Handle]Contact: academic_research@example.com
